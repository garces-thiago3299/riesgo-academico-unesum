<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Materias</title>
 <link rel="stylesheet" href="base.css">
<link rel="stylesheet" href="app-layout.css">

</head>
<body>
<div class="topbar">
  <div>Universe Unesum ‚Äì Panel Acad√©mico</div>
  <div>
    <a href="login.html">Volver al inicio</a>
    <p>
  <a href="riesgo.html">Ir al m√≥dulo de alertas tempranas</a>
</p>
    <a href="#" onclick="cerrarSesion(); return false;">Cerrar sesi√≥n</a>
  </div>
</div>

<header>
  <h1>Sistema Acad√©mico ‚Äì Materias</h1>
  <p>Selecciona una materia para ver asistencias, tareas, notas y el asistente inteligente.</p>
</header>

<main>
  <div class="profile-layout">
    <!-- Perfil lateral -->
    <aside>
      <div class="profile-card" id="profile-card">
        <div class="profile-avatar">üë§</div>
        <button class="profile-upload-btn" type="button">Subir foto</button>
        <div class="profile-name" id="profile-nombre">Usuario</div>
        <div class="profile-line" id="profile-id"></div>
        <div class="profile-line" id="profile-email"></div>
        <div class="profile-career">CARRERA: Universe Unesum</div>
        <div class="profile-line" id="profile-rol"></div>
      </div>
    </aside>

    <!-- Materias -->
    <section>
  <div class="layout-materias">
    <a class="card materia" href="tareas.html?materia=matematicas">Matem√°ticas</a>
    <a class="card materia" href="tareas.html?materia=lenguaje">Lenguaje</a>
    <a class="card materia" href="tareas.html?materia=ingles">Ingl√©s</a>
    <a class="card materia" href="tareas.html?materia=programacion">Programaci√≥n</a>
    <a class="card materia" href="tareas.html?materia=sistemaweb">Sistema Web</a>
  </div>
</section>
  </div>
</main>

<footer>
  Prototipo multi-materia con asistente IA por n8n.
</footer>

<script src="auth.js"></script>
<script>
// Proteger acceso
const rol = localStorage.getItem('rol-actual');
const est = localStorage.getItem('estudiante-actual');
const profMateria = localStorage.getItem('profesor-materia');

if (!rol && !est) {
  window.location.href = 'login.html';
}

// Cerrar sesi√≥n total
function cerrarSesion() {
  clearSesionTotal();
  window.location.href = 'login.html';
}

// Cargar datos de perfil
(function cargarPerfil() {
  const nombreEl = document.getElementById('profile-nombre');
  const idEl = document.getElementById('profile-id');
  const emailEl = document.getElementById('profile-email');
  const rolEl = document.getElementById('profile-rol');

  if (rol === 'profesor' && profMateria) {
    nombreEl.textContent = 'Profesor de ' + profMateria.charAt(0).toUpperCase() + profMateria.slice(1);
    idEl.textContent = 'Usuario: ' + profMateria;
    emailEl.textContent = 'Correo: profesor-' + profMateria + '@unesum.edu.ec';
    rolEl.textContent = 'Rol: Docente';
  } else if (est) {
    const usuarios = getUsuarios();
    const u = usuarios.find(x => x.cedula === est);
    if (u) {
      nombreEl.textContent = u.nombre;
      idEl.textContent = 'C√©dula: ' + u.cedula;
      emailEl.textContent = 'Correo: ' + (u.correo || 'no definido');
      rolEl.textContent = 'Rol: Estudiante';
    } else {
      nombreEl.textContent = 'Estudiante';
      idEl.textContent = 'C√©dula: ' + est;
      rolEl.textContent = 'Rol: Estudiante';
    }
  } else {
    nombreEl.textContent = 'Usuario';
    rolEl.textContent = '';
  }
})();
</script>
</body>
</html>
